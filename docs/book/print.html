<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title></title>
        
        <meta name="robots" content="noindex" />
        
        


        <!-- Custom HTML head -->
        


        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        
        <link rel="icon" href="favicon.svg">
        
        
        <link rel="shortcut icon" href="favicon.png">
        
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        
        <link rel="stylesheet" href="css/print.css" media="print">
        

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        
        <link rel="stylesheet" href="fonts/fonts.css">
        

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        

        
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="abstract.html">Abstract</a></li><li class="chapter-item expanded affix "><li class="part-title">Introduction</li><li class="chapter-item expanded "><a href="introduction/music_theory.html"><strong aria-hidden="true">1.</strong> Music Theory Primer</a></li><li class="chapter-item expanded "><a href="introduction/natural_triads.html"><strong aria-hidden="true">2.</strong> Natural Triads</a></li><li class="chapter-item expanded "><a href="introduction/modality.html"><strong aria-hidden="true">3.</strong> Modality</a></li><li class="chapter-item expanded "><a href="introduction/unnatural_triads.html"><strong aria-hidden="true">4.</strong> Unnatural Triads</a></li><li class="chapter-item expanded "><a href="introduction/additions_and_alterations.html"><strong aria-hidden="true">5.</strong> Additions and Alterations</a></li><li class="chapter-item expanded "><a href="introduction/control_flow_mechanisms.html"><strong aria-hidden="true">6.</strong> Music's Control Flow Mechanisms</a></li><li class="chapter-item expanded affix "><li class="part-title">Language Specification</li><li class="chapter-item expanded "><a href="specification/file_format.html"><strong aria-hidden="true">7.</strong> File Format</a></li><li class="chapter-item expanded "><a href="specification/metadata.html"><strong aria-hidden="true">8.</strong> Metadata</a></li><li class="chapter-item expanded "><a href="specification/the_changes.html"><strong aria-hidden="true">9.</strong> The Changes</a></li><li class="chapter-item expanded "><a href="specification/measure_statements.html"><strong aria-hidden="true">10.</strong> Measure Statements and Chord Expressions</a></li><li class="chapter-item expanded "><a href="specification/superimposed_chords.html"><strong aria-hidden="true">11.</strong> Superimposed Chords</a></li><li class="chapter-item expanded "><a href="specification/repeats.html"><strong aria-hidden="true">12.</strong> Repeats</a></li><li class="chapter-item expanded "><a href="specification/jumps.html"><strong aria-hidden="true">13.</strong> Jumps</a></li><li class="chapter-item expanded affix "><li class="part-title">Implementation</li><li class="chapter-item expanded "><a href="implementation/data_structure.html"><strong aria-hidden="true">14.</strong> Data Structure</a></li><li class="chapter-item expanded affix "><li class="part-title">Use Case</li><li class="chapter-item expanded affix "><li class="part-title">Conclusion</li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                        
                    </div>

                    <h1 class="menu-title"></h1>

                    <div class="right-buttons">
                        
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        
                        
                    </div>
                </div>

                
                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" name="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="abstract"><a class="header" href="#abstract">Abstract</a></h1>
<p>This paper describes a language for expressing the abstracted chord progression and linear control flow of musical compositions.
Coltrane is written in a simple, human-readable plain text format using <a href="https://en.wikipedia.org/wiki/Roman_numeral_analysis">roman numeral analysis (RNA)</a> tokens and control flow structures.
Melodic content is beyond the scope of the language.</p>
<p>The ideas behind Coltrane -- RNA and chord alteration/augmentation -- are well established music theory.
However, there is <a href="https://xkcd.com/927/">some disagreement</a> among theorists as to what can and should be expressed in the analysis and how.
A computer requires the programmer to tell it exactly what to do.
A computer makes no mistakes, as the saying goes.
This unfortunately means that we must make decisions because the computer can't, at least not yet.
It would be burdensome and error-prone to support the parsing of multiple RNA styles, therefore there can only be one set of rules.
This, of course, does not preclude future rule additions and/or alterations.
For instance, support could be added for two syntactically different ways to write the same chord expression.</p>
<p>Although there is a wealth of jazz education literature in the form of method books, etudes, and play-a-longs, there is yet an opportunity to further advance pedagogy with computing power.
The computer can do some of the thinking, which leaves more time for the woodshed.
Developers could theoretically use the language interpreter to create an infinite number of exercises based on a chord progression!</p>
<p>John Coltrane, for the uninitiated, was a saxophonist who they say practiced 12 hours a day and was 20 feet tall.
The motivation behind the development of this language is to help us to find new relationships between chords and musical lines <strong>by playing our  instruments</strong>.</p>
<h1 id="music-theory-primer"><a class="header" href="#music-theory-primer">Music Theory Primer</a></h1>
<p>Feel free to skip this chapter if you have an intermediate knowledge of music theory.
This section is a glossary that will be linked to throughout the paper, so you may skip this section and follow the links back when needed.</p>
<h2 id="chord-progression"><a class="header" href="#chord-progression">Chord progression</a></h2>
<h2 id="chromatic"><a class="header" href="#chromatic">Chromatic</a></h2>
<p>Refers to the scale built upon all 12 tones.
Can also be used in reference to melodic passages or to the notes outside of a scale.</p>
<h2 id="degree-of-the-scale"><a class="header" href="#degree-of-the-scale">Degree of the scale</a></h2>
<p>Each note of the scale is numbered 1-7.
E.G., in the key of C major, A is the sixth degree.</p>
<h2 id="diatonic"><a class="header" href="#diatonic">Diatonic</a></h2>
<p>The notes in a scale, as opposed to the <em>chromatic</em> notes in between.</p>
<h2 id="key"><a class="header" href="#key">Key</a></h2>
<h2 id="resolve-one-chord-to-another"><a class="header" href="#resolve-one-chord-to-another">Resolve one chord to another</a></h2>
<h2 id="scale"><a class="header" href="#scale">Scale</a></h2>
<h2 id="slash-chords"><a class="header" href="#slash-chords">Slash chords</a></h2>
<p>Explicitly states the lowest note in a scale.
Can be used to create an inversion, to use a bass note outside the chord, or to create the impression of a superimposed chord.</p>
<h2 id="superimposed-chords"><a class="header" href="#superimposed-chords">Superimposed Chords</a></h2>
<p>Literally any two chords at the same time.
Chords may share notes, but it is not required.</p>
<h2 id="triad"><a class="header" href="#triad">Triad</a></h2>
<h2 id="wholetone-and-semitone"><a class="header" href="#wholetone-and-semitone">Wholetone and Semitone</a></h2>
<h1 id="natural-triads"><a class="header" href="#natural-triads">Natural Triads</a></h1>
<p>RNA provides a method of abstracting a chord progression away from the key it was composed in.
Each degree of the scale has an associated triad that is built by stacking diatonic thirds upon the root.
We then give this triad a Roman numeral to represent its numerical degree of the scale.</p>
<p>For example in the key of C Major:</p>
<table><thead><tr><th>Root</th><th>Roman</th><th>Spelling</th></tr></thead><tbody>
<tr><td>C</td><td><code>I</code></td><td>C E G</td></tr>
<tr><td>D</td><td><code>ii</code></td><td>D F A</td></tr>
<tr><td>E</td><td><code>iii</code></td><td>E G B</td></tr>
</tbody></table>
<p>.. and so on. For each of the 12 keys, we could spell the natural chords above each step of the scale in the same way and each of them would result in the identical same RNA. A <strong>major triad</strong> is denoted with upper case numerals, and a <strong>minor triad</strong> with lower case numerals.</p>
<p>The natural triads exhibit three permutations (qualities) of triad:</p>
<ul>
<li>Major <code>(I, IV, V)</code></li>
<li>Minor <code>(ii, iii, iv)</code></li>
<li>Diminished <code>(vii^b5)</code></li>
</ul>
<p>The major and minor qualities are especially important because they are integral to tonality and are used as building blocks for more complex chords.
All other chords are described as variants of the basic major and minor triad.</p>
<blockquote>
<p>Assumption: we can reduce any musical composition to a series of triads to which further alterations can be made.</p>
</blockquote>
<p>Any three or more pitches can be expressed in Coltrane.
The language provides easy additions and alterations in a syntax based upon actual charts and pedagogical materials.
While its purpose is to aid in the analysis of tonal music, it is not opinionated.
What Coltrane provides is a <strong>data structure and api</strong>, not an interpreter, per se.</p>
<h1 id="modality"><a class="header" href="#modality">Modality</a></h1>
<p>Looking at the key signature, for many charts, doesn't tell the entire story.
Each key has 7 degrees, each of which is a key in its own right.
We call these keys modes.</p>
<table><thead><tr><th>Degree</th><th>Mode</th></tr></thead><tbody>
<tr><td>I</td><td>Ionian</td></tr>
<tr><td>ii</td><td>Dorian</td></tr>
<tr><td>iii</td><td>Phyrigian</td></tr>
<tr><td>IV</td><td>Lydian</td></tr>
<tr><td>V</td><td>Mixolydian</td></tr>
<tr><td>vi</td><td>Aeolian</td></tr>
<tr><td>vii</td><td>Locrian</td></tr>
</tbody></table>
<p>While there may be other more colorful modes, these are ones we are concerned with in Coltrane; the are based on the major scale.
Whether or not to use a mode is left to the discretion of the Coltrane composer, but it makes the most sense to determine the mode (if it is a mode) and write the code accordingly.</p>
<p>The same numbering process described in <a href="introduction/natural_triads.html">Natural Triads</a> be done starting at any degree of the scale. Start a new count from <code>I/i</code>, matching the quality of the major scale at that degree. For example, the aeolean mode or natural minor:</p>
<table><thead><tr><th>Major</th><th>Minor</th></tr></thead><tbody>
<tr><td><code>I</code></td><td><code>III</code></td></tr>
<tr><td><code>ii</code></td><td><code>iv</code></td></tr>
<tr><td><code>iii</code></td><td><code>v</code></td></tr>
<tr><td><code>IV</code></td><td><code>VI</code></td></tr>
<tr><td><code>V</code></td><td><code>VII</code></td></tr>
<tr><td><code>vi</code></td><td><code>i</code></td></tr>
<tr><td><code>vii</code></td><td><code>ii</code></td></tr>
</tbody></table>
<h1 id="unnatural-triads"><a class="header" href="#unnatural-triads">Unnatural Triads</a></h1>
<p>In practice, chord progressions are not limited to the natural triads. 
Composers are at liberty to choose whatever quality of triad, in whatever inversion, with whatever additions or alterations, at whatever point in the chromatic scale, at any time in a progression with complete disregard for conventional tonality.
The roman numeral system and Coltrane do not directly address this fact. To reiterate, we are expressing a relationship to the <strong>current key</strong>.</p>
<p>Still, we must be able to represent chords that do not belong to a key.
An example should help to understand how this works in Coltrane.
The cornerstone of tonal music, the <code>V-I</code> authentic cadence, which creates a feeling of resolution.
It is common for a composer to &quot;target&quot; a certain degree as if resolving to that key using what is known as a borrowed chord.
In both dorian and aeolian minor, the fifth degree is naturally minor, but we borrow <code>V</code> as if we are creating a <code>V-I</code>.
This is what would be considered a deceptive cadence, and is often found somewhere prior to an authentic cadence.
Consider: <code>A Dm G C</code> and <code>VI ii V I</code>.
Notice the <code>VI</code> chord; the sixth degree would naturally be <code>vi</code>.
This is how the Coltrane language represents a &quot;five of two&quot; and other borrowed chords.
A Coltrane RNA token is based on the <strong>quality</strong> and <strong>degree</strong> and can be made to describe any chord in terms of <strong>semitones from tonic</strong>.
To be more specific, unless the composer specifies an explicit key change, we require that chords be expressed in the context of the specified key.</p>
<p>For example, all 12 notes in the C Major context:</p>
<table><thead><tr><th>1</th><th>2</th><th>3</th><th>4</th><th>5</th><th>6</th><th>7</th><th>8</th><th>9</th><th>10</th><th>11</th><th>12</th></tr></thead><tbody>
<tr><td>C</td><td>C#/Db</td><td>D</td><td>D#/Eb</td><td>E</td><td>F</td><td>F#/Gb</td><td>G</td><td>G#/Ab</td><td>A</td><td>A#/Bb</td><td>B</td></tr>
<tr><td><code>I</code></td><td><code>#I/bII</code></td><td><code>II</code></td><td><code>#II/bIII</code></td><td><code>III</code></td><td><code>#III/bIV</code></td><td><code>IV</code></td><td><code>V</code></td><td><code>#V/bVI</code></td><td><code>VI</code></td><td><code>#VI/bVII</code></td><td><code>VII</code></td></tr>
</tbody></table>
<p>Note: The numerals above are all capital, but they could be either major or minor.</p>
<h1 id="additions-and-alterations"><a class="header" href="#additions-and-alterations">Additions and Alterations</a></h1>
<h2 id="additions"><a class="header" href="#additions">Additions</a></h2>
<p>Chords are not limited to three notes; we can add notes above the chord in thirds (3 or 4 semitones).
The most common of these alterations is the 7th. We can continue upward to the 9, 11, and 13 before coming full circle.</p>
<blockquote>
<p>Assumption: any chord with additions -- <code>(9, 11, 13)</code> -- also contains the chord tones between the noted addition and the triad. </p>
</blockquote>
<p>For instance, a <code>13</code> chord also contains <code>[7, 9, 11]</code>.
The intended side-effect of this approach is that the language is equipped to analyze jazz compositions rather than generalized for a broader approach.
The language can be used with or without chord alterations for any tonal or non-tonal composition, it simply makes assumptions about chord spellings that are based upon the jazz idiom.</p>
<p>The reasoning behind this decision is simple and pragmatic: we intend to draw scales from these expressions, so the language forces you to be specific.
The &quot;color&quot; of the chord and scale is based upon these extension notes, so it is very important that the language is concrete in the referencing of extension notes.
Any chord can be spelled through alteration expressions, but for brevity and ergonomics we can omit any diatonic additions between the 7th and the last alteration.</p>
<h2 id="alterations"><a class="header" href="#alterations">Alterations</a></h2>
<p>Any note in a chord can be targeted with an alteration, whether a component of the triad or an addition.
Adding a <code>#</code> or <code>b</code> before the degree number to raise or lower it by a semitone.
The degree can be entered as any number 1-13, although <code>[9, 11, 13]</code> are preferred over <code>[2, 4, 6]</code>.
This property could be use to create tones an octave +/- 1 semitone apart.</p>
<p>An extreme example of alteration and dissonance: <code>1:IV^b5,b9,b10,#13</code>.</p>
<h1 id="musics-control-flow-mechanisms"><a class="header" href="#musics-control-flow-mechanisms">Music's Control Flow Mechanisms</a></h1>
<p>Musical language, much like programming languages, has flow from one point to another.
In the case of written music, we could express this as a rigid decision tree for which every branch of the tree is reached. </p>
<p>Coltrane, however, is not rigid.
It has no specific requirement that all branches must be reached and does not expect the tree to be constant during runtime.
We could reach into the program and directly alter the values contained in the data structures of our &quot;running&quot; composition.</p>
<p>We have an entry point: the first measure. From there we proceed measure by measure until we reach a control flow statement.</p>
<h2 id="repeats"><a class="header" href="#repeats">Repeats</a></h2>
<p>There are two kinds of repeats that the language can express: bar line repeat and branching repeat.
A bar line repeat looks something like ùÑÜùÑöùÑöùÑöùÑá <code>||:   :||</code> and results in a simple loop.
A branching repeat uses the same bar line notation but has different endings, marked above the staff with numbered brackets.
A composition can have any number of repeats and any number of branches. 
Thankfully, most music can be expressed with simple control flow, but the language supports arbitrary levels of nested repeats.
If repeats are nested inside of each other, they resolve in a similar manner to parentheses, e.g. <code>( () (()) )</code>.
The interpreter will error if the repeats provided in the source do not resolve.</p>
<h2 id="jumps"><a class="header" href="#jumps">Jumps</a></h2>
<p>The language provides a jump statement that causes the control flow to jump to the specified measure, optionally an arbitrary number of times.
In musical notation this construct is known as <em>dal signo al coda</em>, <em>da capo al fine</em>, etc.
If our jump takes us to a point prior to any <em>repeat</em> expression, the repeats will be reset to their original state unless specified.</p>
<p>Creating a <em>dal signo al coda</em> requires:</p>
<table><thead><tr><th></th><th></th></tr></thead><tbody>
<tr><td>1. Jump that may be skipped once to activate</td><td><em>al coda</em></td></tr>
<tr><td>2. Jump to a point in the progression prior to the <em>al coda</em></td><td>ùÑâ <em>del signo</em></td></tr>
<tr><td>3. Target of 1</td><td>ùÑå <em>coda</em></td></tr>
<tr><td>4. Target of 2</td><td>ùÑã <em>signo</em></td></tr>
</tbody></table>
<p>A jump can be set to jump any number of times, and a target will simply keep receiving it.
It could also be set to only jump on the nth pass.</p>
<h2 id="ending"><a class="header" href="#ending">Ending</a></h2>
<p>In musical notation, especially sheet music, it is simple to determine where the end is. In musical performance, the story is completely different.
During rehearsal performers will decide how many choruses to play, how many times to repeat the head, unwritten interludes, etc.
The language permits &quot;unwritten changes&quot; and arrangement by virtue of the code being intuitive to write.
We can parse the code again and then update the data structure while running.</p>
<p>A composition ends either when we run out of measures or we encounter an activated <code>fine</code> keyword.
A fine can optionally be set to activate after n passes for <em>al fine</em> jumps.
The language doesn't directly support the idea of an infinite loop, but one could simply max out the repeat count value.
The language is not concerned with the ending of the composition.
The code is parsed and then we simply run the resulting data structure through an interpreter.
The interpreter with come to a stopping point, whether that be the specified ending or some sort of error.</p>
<h1 id="file-format"><a class="header" href="#file-format">File Format</a></h1>
<p>At a glance, Coltrane would appear to be a toml file, with its ini-style sections, but there are only two permitted headings: <code>[meta]</code> and <code>[changes]</code>.</p>
<ul>
<li>The file ending for the language is <code>.chg</code>, which is short for changes.</li>
<li>The file must be in utf-8 encoding with Unix line endings.</li>
</ul>
<h1 id="metadata"><a class="header" href="#metadata">Metadata</a></h1>
<p>A source file begins with a header that details the composition's metadata. There are required and optional fields.</p>
<p>Required fields:</p>
<pre><code>[meta]
title=A Night In Tunisia
by=Dizzy Gillespie
meter=4/4
</code></pre>
<p>Optional Fields:</p>
<pre><code>key=F
mode=Mixolydian
</code></pre>
<p>Each line must be in the format [key]=[value], but it also supports spaces before and after the equals: [key] = [value].</p>
<h1 id="the-changes"><a class="header" href="#the-changes">The Changes</a></h1>
<p>This section is where the Coltrane language itself is used.
The changes is line break delimited, each line constitutes a <strong>statement</strong>.
These statements can be measures, control flow, or comments</p>
<p>It is required that there be no more than one <em>measure</em> statement per line, but there can be any number of <em>chord</em> expressions within that line.</p>
<p>These statements can either be control flow or measures.</p>
<h2 id="statement-vs-expression"><a class="header" href="#statement-vs-expression">Statement vs Expression</a></h2>
<p>Just as in programming languages, Coltrane makes a distinction between a statement and an expression.
Simply put, an statement is composed of an expression or multiple expressions.</p>
<p>A control flow expression is statement composed of exactly 1 expression.
Many chord expressions can be combined in a single line to form 1 measure statement.</p>
<p>The distinction is not important for Coltrane composers, but it bears mentioning because of the importance of the line break.
For the composer, it suffices to understand the importance of statements each being on their own line.</p>
<h2 id="comments"><a class="header" href="#comments">Comments</a></h2>
<p>Coltrane supports single line comments marked by a <code>$</code> at the beginning of the line.
Anything after the <code>$</code> is disregarded by the parser.
A comment can be used in any part of the source file, not just in <code>[changes]</code>.</p>
<pre><code>[changes]
$ introduction: bass line
1:bVII7
1:vi
</code></pre>
<h1 id="measure-statements-and-chord-expressions"><a class="header" href="#measure-statements-and-chord-expressions">Measure Statements and Chord Expressions</a></h1>
<p>A measure statement consists of a series of chord expressions.
These chord expressions can be explicit, denoting the beginning and ending point, the triad, and any additions, but there are also methods for abbreviating them.</p>
<p>The basic formula for a chord statement is:</p>
<pre><code>[BeginLocation:][Triad][^Additions][:EndLocation]
</code></pre>
<p>If the chord extends to the following change, <code>[:EndLocation]</code> may be omitted. If there are no additions <code>[^Additions]</code> may be omitted.</p>
<p>For example, <code>1:vii^7b5 3:III^7b5</code> constitutes a complete measure statement.
Supposing each chord is a quarter note, with a quarter rest in between we would write <code>1:vii^7b5:2 3:III^7b5:4</code>.
Please note that the <code>[EndLocation]</code> component is not inclusive, the chord ends <em>on</em> that beat or subdivision.
To make a rest or no chord (NC), leave a gap between one chord expression's end and the next one's start.</p>
<p>If a statement begins with a chord expression it must contain only chord expressions.</p>
<h2 id="chord-expressions"><a class="header" href="#chord-expressions">Chord Expressions</a></h2>
<h3 id="start-and-end-component-aka-location"><a class="header" href="#start-and-end-component-aka-location">Start and End Component (aka location)</a></h3>
<p>A chord's location can be expressed as an integer if the note begins/ends on the beat or a float if the note begins/ends on a subdivision of the beat.
These are divisions of the note expressed as a float. For example, a dotted quarter note: <code>1:V^7b5:2.5</code>.</p>
<p>For reference, the following table shows common float values:</p>
<table><thead><tr><th>Name</th><th>Float</th></tr></thead><tbody>
<tr><td>ùÖ° 16th triplet</td><td>0.167</td></tr>
<tr><td>ùÖ° 16th</td><td>0.25</td></tr>
<tr><td>ùÖ† 8th triplet</td><td>0.33</td></tr>
<tr><td>ùÖ† 8th</td><td>0.5</td></tr>
<tr><td>ùÖ°ùÖ≠ dotted 16th</td><td>0.375</td></tr>
<tr><td>ùÖ†ùÖ≠ dotted 8th</td><td>0.75</td></tr>
</tbody></table>
<p>Off-beat chords are not very common, even in jazz, beyond the 8th note.
A 2-bar excerpt from Wayne Shorter's &quot;Armageddon&quot; shows a common off-beat rhythm:</p>
<pre><code>$ Key is not marked, assuming B7 -&gt; E7 = E mixolydian
$ :: means &quot;continue last chord for a full measure&quot;
1:I^7 2.5:bII^7 4.5:IV^7#11
::
</code></pre>
<p>Two chords can overlap; the second starts at the same location as the end of the first.
That is, you can explicitly state the end location to be the same as the next chord, but it optional.
It would be the same result to omit it.</p>
<p>Chords can span the bar line, as shown in the example above.
If the chord carries over the bar  line, but is not a full measure chord, simply add the next chord, e.g. <code>:: 3:V^7</code></p>
<p>If a chord is valid for the entire measure, simply write the triad and additions omitting start and end values.
For example: <code>V^7b5</code> or <code>ii^7</code></p>
<h2 id="triad-component"><a class="header" href="#triad-component">Triad Component</a></h2>
<p>This is the RNA portion of the measure statement. The options here are relatively limited. It consists of a roman numeral between 1 and 7, with an optional flat or sharp alteration prefix. For example <code>bVII</code> or <code>iv</code>. Capital letters denotes a major triad, lower case a minor triad.</p>
<blockquote>
<p>There is an exception in the case of the literal <code>vii</code>, which is a diminished chord diatonically. Otherwise, we denote a diminished chord with a <code>b5</code> alteration as in <code>V7b5</code></p>
</blockquote>
<p>If there is a <code>b</code> or <code>#</code> prefix, the root is lowered or raised by one semitone, respectively. There is no <code>dd</code> or <code>##</code> (double flat/sharp). In that instance, the next lower step should be used. The intent is to represent the notes from the perspective of the key center. If there is a triad based upon a natural step of the scale, it should be preferred over a flatted or sharped triad.</p>
<p>There are 12 tones total in the western temperament.</p>
<pre><code>1     2     3     4     5     6     7     8     9     10    11    12
C     C#/Db D     D#/Eb E     F     F#/Gb G     G#/Ab A     A#/Bb B
I           II          III   IV          V           VI          VII
</code></pre>
<p>For each tone not in the diatonic scale, the root can be written using either a flat or sharp prefix. Again, it is typical to decide this based on the current key center. For flat keys, prefer the flat prefix and for sharp keys, prefer the sharp prefix. Both chords are otherwise equivalent.</p>
<h3 id="additions-and-alterations-1"><a class="header" href="#additions-and-alterations-1">Additions and Alterations</a></h3>
<h3 id="inversions"><a class="header" href="#inversions">Inversions</a></h3>
<h3 id="slash-chords-1"><a class="header" href="#slash-chords-1">Slash Chords</a></h3>
<h3 id="superimposed-chords-1"><a class="header" href="#superimposed-chords-1">Superimposed Chords</a></h3>
<h1 id="superimposed-chords-2"><a class="header" href="#superimposed-chords-2">Superimposed Chords</a></h1>
<h1 id="repeats-1"><a class="header" href="#repeats-1">Repeats</a></h1>
<h1 id="jumps-1"><a class="header" href="#jumps-1">Jumps</a></h1>
<h1 id="data-structure"><a class="header" href="#data-structure">Data Structure</a></h1>
<p>The Coltrane library takes a plain text file that contains a section marked <code>[changes]</code>, which is parsed to create a tree data structure.
Each leaf of the tree represents a customized version of the same generic object.</p>
<p>The common functions for this generic object are</p>
<ul>
<li>
<p><code>Option(NextObject)</code></p>
</li>
<li>
<p><code>Option(PreviousObject)</code></p>
</li>
<li>
<p><code>Do()</code> function/callbacks</p>
<p>The do function can make changes to the underlying data structure. e.g. to remove/alter a branch after a certain number of passes.</p>
</li>
</ul>
<h2 id="built-in-components"><a class="header" href="#built-in-components">Built-in Components</a></h2>
<h3 id="chord-expression"><a class="header" href="#chord-expression">Chord Expression</a></h3>
<h3 id="jump"><a class="header" href="#jump">Jump</a></h3>
<h3 id=""><a class="header" href="#"></a></h3>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        

                        

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                

                
            </nav>

        </div>

        
        <!-- Livereload script (if served using the cli tool) -->
        <script type="text/javascript">
            var socket = new WebSocket("ws://localhost:3000/__livereload");
            socket.onmessage = function (event) {
                if (event.data === "reload") {
                    socket.close();
                    location.reload();
                }
            };

            window.onbeforeunload = function() {
                socket.close();
            }
        </script>
        

        

        

        
        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        

        

        
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        

        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        

        
        
        <script type="text/javascript">
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>
        
        

    </body>
</html>
